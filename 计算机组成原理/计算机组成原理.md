# 计算机组成原理

[toc]

## 1 计算机系统概论

### 1.1 计算机系统简介

#### 1.1.1 计算机的软硬件概念

**硬件**：计算机的实体部分
**软件**：

* 系统软件
* 应用软件

#### 1.1.2 计算机系统的层次结构

![images](images/屏幕截图%202023-09-24%20114553.png)

固件：把软件存于只读存储器中

#### 1.1.3 计算机组成和计算机体系结构

1、作用不同

计算机组成指的是系统结构的逻辑实现，包括机器机内的数据流和控制流的组成及逻辑设计等。主要分为五个部分：控制器，运算器，存储器，输入设备，输出设备。

计算机体系结构是指根据属性和功能不同而划分的计算机理论组成部分及计算机基本工作原理、理论的总称。其中计算机理论组成部分并不单与某一个实际硬件相挂钩，如存储部分就包括寄存器、内存、硬盘等。

2、组成不同

计算机组成的任务是在指令集系统结构确定分配给硬件系统的功能和概念结构之后，研究各组成部分的内部构造和相互联系，以实现机器指令集的各种功能和特性。这种联系包括各功能部件的内部和相互作用。

计算机体系结构是程序员所看到的计算机的属性，即计算机的逻辑结构和功能特征，包括其各个硬部件和软部件之间的相互关系。

3、功能不同

计算机组成要解决的问题是在所希望达到的性能和价格下，怎样最佳，最合理地把各个数倍和部件组成成计算机，已实现所确定的ISA。

计算机体系结构主要研究软件、硬件功能分配和对软件、硬件界面的确定。20世纪70年代以来，在计算机软件方面有了显著的进展。

### 1.2 计算机的基本组成

#### 1.2.1 冯·诺依曼计算机的特点

1. 计算机由五大部件组成
2. 指令和数据以同等地位存于存储器
3. 指令和数据用二进制表示
4. 指令由操作码和地址组成
5. **存储程序**(核心)
6. 以运算器为中心

* 系统复杂性管理方法
  * 层次化:将被设计的系统划分为多个模块或子模块
  * 模块化:有明确定义的功能和接口
  * 规则性:模块跟容易被重用

#### 1.2.2 计算机的硬件框图

![images](images/屏幕截图%202023-09-24%20120831.png)
von.Neumann计算机结构框图

![images](images/屏幕截图%202023-09-24%20121711.png)
以存储器为核心的计算机结构框图

运算器：用来完成算数运算和逻辑运算，并将结果暂存在运算器内
存储器：存放数据和程序
控制器：控制指挥程序和数据的输入，运行以及处理运算结果
输入设备：略
输出设备：略

![图片](images/截图%202023-08-14%2012-07-40.png)

![images](images/屏幕截图%202023-09-24%20122316.png)
现代计算机体系框图
![images]()
![images]()
![images]()
![images]()

### 1.3 计算机硬件的主要技术指标

1. 机器字长：CPU一次能处理的数据位数，与CPU中寄存器的位数有关

2. 运算速度

   * 主频
   * 核数，每个核支持的线程数
   * 吉普森法：$T_M=\sum^n_{i=1}f_it_i$
   * CPI：执行一条指令所需的时钟周期
   * MIPS：每秒执行百万条指令
   * FLOPS：每秒浮点运算次数

3. 存储容量：存放二进制信息的总位数

   * 主存容量
   * 存储单元个数$\times$储存字长
        | MAR  | MDR  |      容量       |
        | :--: | :--: | :-------------: |
        |  10  |  8   |  1K$\times$8位  |
        |  16  |  32  | 64K$\times$32位 |

        $1K=2^{10}$

   * 字节数
    $2^{13}b=1KB$
    $2^{21}b=256KB$
    $1B=2^{3}b$
   * 辅存容量 字节数 80GB

## 系统总线

### 总线的基本概念

1. 什么是总线：总线是连接各个部件的信息传输线，是各个部件共享的传输介质
2. 总线上信息的传输

   * 串行：同一时刻，只能传输一个bit位的信号，只需要一根信号线。
   * 并行：同一时刻，可以传输多个bit位的信号，有多少个信号位就需要多少根信号线。

3. 总线结构的计算机举例

   * 单总线结构框图
    ![图片](images/屏幕截图%202023-09-03%20131303.png)
   问题：总线征用

   * 面向CPU的双总线结构框图
    ![图片](images/屏幕截图%202023-09-03%20131949.png)

   * 以存储器为中心的双总线结构框图
    ![图片](images/屏幕截图%202023-09-04%20154208.png)

### 总线的分类

1. 片内总线:芯片内部的总线
2. 系统总线:计算机部件之间的信息传输线
   1. 数据总线：双向 条数与机器字长、存储字长有关
   2. 地址总线：单向 与存储地址、I/O地址有关
   3. 控制总线：有出 存储器读、存储器写、总线允许、中断确认 有入 中断请求、总线请求
3. 通信总线
 用于计算机系统之间或计算机系统与其他系统之间的通信
 传输方式有串行通信总线和并行通信总线

### 总线特性和性能指标

1. 总线的物理实现
 ![images](images/屏幕截图%202023-09-04%20160217.png)
2. 总线的特性
   1. 机械特性：尺寸、形状、管脚数、排列顺序
   2. 电气特性：传输方向和有效的电平范围
   3. 功能特性：每根传输线的功能地址、数据、控制
   4. 时间特性：信号的时序关系
3. 总线的性能指标
   1. 总线宽度：数据线的根数
   2. 标准传输率：每秒输出的最大字节数(MBps)
   3. 时钟同步/异步：同步、不同步
   4. 总线复用：地址线和数据线复用
   5. 信号线数：地址线、数据线、控制线的总和
   6. 总线控制方式：突发、自动、仲裁、逻辑、计数
   7. 其他指标：负载能力
4. 总线的标准
 ![images](images/屏幕截图%202023-09-04%20162010.png)
5. 总线结构
   * 双总线结构
    ![images](images/屏幕截图%202023-09-04%20162657.png)
   * 三总线结构一
    ![images](images/屏幕截图%202023-09-04%20163029.png)
    DMA：直接内存访问（DMA，Direct Memory Access）是一些计算机总线架构提供的功能，它能使数据从附加设备（如磁盘驱动器）直接发送到计算机主板的内存上
   * 三总线结构二
    ![images](images/屏幕截图%202023-09-04%20163451.png)
   * 四总线结构
    ![images](images/屏幕截图%202023-09-04%20163656.png)
   * 传统微机总线结构
    ![images](images/屏幕截图%202023-09-04%20163847.png)
   * VL-BUS局部总线结构
    ![images](images/屏幕截图%202023-09-04%20164104.png)
   * PCI总线结构
    ![images](images/屏幕截图%202023-09-04%20164217.png)
   * 多层PCI总线结构
    ![images](images/屏幕截图%202023-09-04%20164404.png)

### 总线控制

1. 总线判优控制

   * 主设备(模块) 对总线有**控制权**
   * 从设备(模块) **响应**从主设备发来的总线命令
   * 集中式
     * 链式查询
      ![images](images/屏幕截图%202023-09-05%20101141.png)
     * 计数器定时查询
      ![images](images/屏幕截图%202023-09-07%20152821.png)
      数据线：数据的传输
      地址线：设备的查找
      BR：总线请求
      BS：总线忙
      优点：优先级次序设定灵活
      缺点：速度慢
     * 独立请求方式
      ![images](images/屏幕截图%202023-09-07%20153432.png)

   * 分布式

2. 总线通信控制

   * 目的解决通信双方协调配合问题
   * 总线传输周期
    申请分配阶段 主模块申请，总线仲裁决定
    寻址阶段 主模块从模块给出地址和命令
    传数阶段 主模块和从模块交换数据
    结束阶段 主模块撤销相关信息

3. 总线通信的四种方式
   * 同步通信：由统一时标控制数据传送
   同步式数据输入
   ![images](images/屏幕截图%202023-09-07%20160834.png)
   同步式数据输入
   ![images](images/屏幕截图%202023-09-07%20161053.png)
   适用于总线长度较短，各个模块存取时间比较一致的情况下
   * 异步通信：采用应答方式，没有公共时钟标准
   ![images](images/屏幕截图%202023-09-07%20161453.png)
   * 半同步通信：同步、异步相结合
   同步：发送方用系统时钟前沿发信号；接收方用用系统时钟后沿判断、识别
   异步：允许不同速度的模块和谐工作；增加一条“等待”响应信号**WAIT**
   以输入数据为例
   ![images](images/屏幕截图%202023-09-07%20162122.png)
   ![images](images/屏幕截图%202023-09-07%20162338.png)
   以上三种方法的共同点
   主模块发地址命令时占用总线
   从模块准备数据时总线空闲
   从模块向主模块发数据占用总线

   * 分离式通信：充分挖掘系统总线每个瞬间的潜力
   一个总线传播周期
   子周期1 主模块申请占用总线，使用完后放弃总线的使用权
   子周期2 从模块申请占用总线，将各种信息送至总线上
   特点
      * 各模块有权申请占用总线
      * 采用同步方式通信，不等待对方回答
      * 个模块准备数据时，不占用总线
      * 总线被占用时无空闲

## 存储器

### 存储器分类

1. 按存储介质分类
   半导体存储器 TTL、MOS 易失：断电后数据丢失
   磁表面存储器 磁头、磁载体 非易失
   磁芯存储器 硬磁材料、环装原件 非易失
   光盘存储器 激光、磁光材料 非易失
2. 按存取方式分类
   存取时间和物理地址无关（随机访问）
   * 随机存储器 在程序中可读可写
   * 只读存储器
   存取时间和物理地址有关（串行访问）
     * 顺序存放存储器 磁带
     * 直接存取存储器 磁盘
3. 按在计算机中的作用分类
   主存储器
   * RAM
     * 静态RAM
     * 动态RAM
   * ROM
     * MROM
     * PROM
     * EPROM
     * EEPORM
   Flash Memory
   高速缓冲存储器（Cache）
   辅助存储器 磁盘、磁带、光盘

### 储存器的层次结构

1. 存储器三个主要关系的关系
   ![images](images/屏幕截图%202023-09-09%20155821.png)
2. 缓存-主存和主存-辅存
   ![images](images/屏幕截图%202023-09-09%20161001.png)
   缓存和主存之间用硬件连接
   主存和辅存之间用软件和硬件连接

### 主存储器

1. 主存的基本组成
   ![images](images/屏幕截图%202023-09-09%20161536.png)
2. 主存和CPU之间的联系
   ![images](images/屏幕截图%202023-09-09%20161846.png)
3. 主存中存储单元地址的分配
   ![images](images/屏幕截图%202023-09-09%20162630.png)
   地址线的长度决定了寻址范围，比如有32地址线，寻址空间为2^32次方个存储单元
   从0000----000(32位)
   到1111----111(32位)
   共有可以表示2^32个地址范围
4. 主存的技术指标
   存储容量 主存存放二进制代码的总位数
   存储速度
   * 存取时间 存储器的访问时间 读出时间 访问时间
   * 存取周期 连续两次独立的存储器操作（读或写）所需的最小时间间隔
   存储器的带宽 位/秒
   ![images]()
   ![images]()
