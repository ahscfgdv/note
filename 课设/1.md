# 量化投资

## RNN算法原理

RNN简介：RNN之所以称为循环神经网路，即一个序列当前的输出与前面的输出也有关。具体的表现形式为网络会对前面的信息进行记忆并应用于当前输出的计算中，即隐藏层之间的节点不再无连接而是有连接的，并且隐藏层的输入不仅包括输入层的输出还包括上一时刻隐藏层的输出。

RNN模型简单来说就是不仅仅把当前时刻t的输入作为参数，他的参数还包括了t-1时刻，以及以前的时刻的结果作为输入这样RNN循环神经网络就可以处理有时间关系的数据了。不同的时刻之间共享一个权重矩阵$W_s$这样可以有效的降低所需要的参数

![images](./images/屏幕截图%202023-12-30%20133858.png)


## 数据来源以及选取原因

The OPEC is a comprehensive collection of crude oil prices declared by oil-producing countries over time.

The Organization of the Petroleum Exporting Countries OPEC is a permanent, intergovernmental Organization, created at the Baghdad Conference. OPEC's objective is to co-ordinate and unify petroleum policies among Member Countries, in order to secure fair and stable prices for petroleum producers; an efficient, economic and regular supply of petroleum to consuming nations; and a fair return on capital to those investing in the industry.

预测原油价格对各种利益相关者都有很多好处：

1. **投资决策：** 对投资者来说，准确的原油价格预测可以帮助他们做出更明智的投资决策。如果能够预测到原油价格的走势，投资者可以更有效地管理风险、制定更好的投资策略，并更及时地调整投资组合。

2. **经济规划和政策制定：** 政府和央行等政策制定者可以利用原油价格的预测信息来规划经济政策。油价的波动通常会影响到通货膨胀、就业和经济增长，因此对原油价格的预测能够为政策制定者提供重要的参考依据。

3. **能源企业决策：** 原油价格对能源企业的生产、采购和销售等方面都有直接影响。准确的价格预测能够帮助企业制定更合理的生产和营销策略，规避风险，并且更好地适应市场变化。

4. **全球经济稳定性：** 原油价格波动对全球经济稳定有着重要影响。对原油价格的准确预测可以有助于维持全球经济的稳定，并且在经济下行期间提供一定的警示。

5. **资源分配和节约：** 对原油价格的准确预测能够帮助各个行业更有效地进行资源分配，鼓励能源节约和可持续发展，减少资源的浪费。

## 代码整体逻辑解释



## 参数解析

**window size**：指的是输入序列中用于处理的时间步数量或者是用来捕捉序列信息的窗口长度。

**Activation**：激活函数是用来加入非线性因素的，提高神经网络对模型的表达能力，解决线性模型所不能解决的问题。激活函数能够将输入映射到另一个空间中，提取数据的特征并进行非线性变换。这有助于网络学习到数据中的抽象特征和高级表示，使其更适合于解决复杂的问题。 某些激活函数（比如ReLU的变种）在负值上引入稀疏性，有助于模型学习稀疏表示，同时还可以起到一定的正则化作用，防止过拟合。一些激活函数能够有助于更有效地传播梯度，有利于训练深层神经网络。通过合理选择激活函数，可以避免梯度消失或梯度爆炸的问题，有助于更稳定地训练模型。

**Dense**：tensorflow中的全连接层在RNN循环神经网络中用来收集循环神经网络得到的结果输出一个线性值。

**optimizer**：优化器用于调整神经网络中每个层的参数例如权重和偏置。计算损失函数对于每个可训练参数的梯度。这些梯度用于指导参数更新的方向和大小。
常用的优化器有
- 随机梯度下降（SGD）： 是最基础的优化器之一，在每次迭代中使用单个样本或一小批样本的梯度来更新模型参数。SGD的缺点是可能会陷入局部最优点，对于复杂的非凸损失函数可能表现不佳。
- Adam（Adaptive Moment Estimation）： 结合了动量优化器和自适应学习率的特性。Adam根据每个参数的历史梯度自适应地调整学习率，具有较好的性能，被广泛应用于各种深度学习任务中。在本次任务中选择的就是Adam优化器。
- Adagrad（Adaptive Gradient Algorithm）： 自适应地为每个参数分配不同的学习率，对频繁出现的参数降低学习率，对不经常出现的参数提高学习率。但它可能在训练后期导致学习率过小，造成训练停滞。

**loss**：损失函数用于度量模型预测结果与实际标签之间的差异或误差。它衡量了模型在训练数据上的表现，指示了模型需要朝着何种方向调整参数以减小误差。通过梯度下降（或其变种）最小化损失函数，模型能够学习在训练数据上更好地拟合目标值，即最大限度地减小预测值与真实值之间的差距。
常见损失函数
- 均方误差（Mean Squared Error，MSE）： 适用于回归问题，衡量模型预测值与实际值之间的平方差。MSE对异常值比较敏感。在我们预测原油价格的项目中选用的就是均方误差。
- 交叉熵损失（Cross Entropy Loss）： 用于分类问题，常与softmax激活函数结合使用，衡量模型输出的概率分布与实际类别的差异。包括二元交叉熵（Binary Cross Entropy）和多类交叉熵（Categorical Cross Entropy）。
- 对数似然损失（Log-Likelihood Loss）： 用于概率建模任务，比如逻辑回归和某些类型的神经网络，衡量模型的预测与实际概率分布的负对数似然。

**metrics**：用于评估模型性能和衡量模型预测结果的准确度。与损失函数不同，损失函数用于优化模型参数，而指标用于评估训练过程中模型的性能。
对于分类任务可以选择模型预测的准确率作为评价指标，在我们的项目中并没有使用

**Epochs**：模型训练的轮数

## 辩证性结论总结